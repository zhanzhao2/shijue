<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>ğŸ  å°åŒºäººè„¸ç³»ç»Ÿ - æ™ºèƒ½é—¨ç¦ç®¡ç†</title>
    <link rel="stylesheet" href="/styles.css" />
  </head>
  <body>
    <main class="container">
      <h1 class="floating">ğŸ” å°åŒºäººè„¸è¯†åˆ«ç³»ç»Ÿ</h1>
      
      <nav class="nav">
        <a class="button" href="/register.html">
          ğŸ‘¤ äººè„¸æ³¨å†Œ
        </a>
        <a class="button secondary" href="/recognize.html">
          ğŸ¯ äººè„¸è¯†åˆ«
        </a>
      </nav>

      <section class="card info-section">
        <h2>ğŸ“Š å·²æ³¨å†Œäººå‘˜</h2>
        <div id="peopleCount" class="status">æ­£åœ¨åŠ è½½...</div>
        <ul id="peopleList" class="list"></ul>
        <div id="emptyState" style="display: none; text-align: center; padding: 40px; color: #6b7280;">
          <div style="font-size: 48px; margin-bottom: 16px;">ğŸ‘¥</div>
          <p>è¿˜æ²¡æœ‰æ³¨å†Œç”¨æˆ·</p>
          <p>ç‚¹å‡»ä¸Šæ–¹"äººè„¸æ³¨å†Œ"å¼€å§‹æ·»åŠ ç”¨æˆ·</p>
        </div>
      </section>

      <div class="card" style="text-align: center; margin-top: 24px;">
        <h2>ğŸš€ ç³»ç»Ÿç‰¹æ€§</h2>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-top: 20px;">
          <div style="padding: 16px; background: rgba(102, 126, 234, 0.1); border-radius: 12px;">
            <div style="font-size: 32px; margin-bottom: 8px;">âš¡</div>
            <strong>å®æ—¶è¯†åˆ«</strong>
            <p style="font-size: 14px; color: #6b7280; margin: 4px 0 0;">æ¯«ç§’çº§å“åº”é€Ÿåº¦</p>
          </div>
          <div style="padding: 16px; background: rgba(239, 68, 68, 0.1); border-radius: 12px;">
            <div style="font-size: 32px; margin-bottom: 8px;">ğŸ›¡ï¸</div>
            <strong>å®‰å…¨å¯é </strong>
            <p style="font-size: 14px; color: #6b7280; margin: 4px 0 0;">æœ¬åœ°æ•°æ®å­˜å‚¨</p>
          </div>
          <div style="padding: 16px; background: rgba(16, 185, 129, 0.1); border-radius: 12px;">
            <div style="font-size: 32px; margin-bottom: 8px;">ğŸ“±</div>
            <strong>æ˜“äºä½¿ç”¨</strong>
            <p style="font-size: 14px; color: #6b7280; margin: 4px 0 0;">ç®€å•ç›´è§‚çš„ç•Œé¢</p>
          </div>
        </div>
      </div>
    </main>

    <script>
      async function refreshPeople() {
        try {
          const countEl = document.getElementById('peopleCount');
          const listEl = document.getElementById('peopleList');
          const emptyEl = document.getElementById('emptyState');
          
          countEl.innerHTML = '<span class="loading"></span> æ­£åœ¨åŠ è½½...';
          
          const res = await fetch('/cv/people');
          const data = await res.json();
          const people = data.people || [];
          
          if (people.length === 0) {
            countEl.textContent = 'æš‚æ— æ³¨å†Œç”¨æˆ·';
            listEl.style.display = 'none';
            emptyEl.style.display = 'block';
          } else {
            countEl.textContent = `å…±æœ‰ ${people.length} åå·²æ³¨å†Œç”¨æˆ·`;
            listEl.style.display = 'block';
            emptyEl.style.display = 'none';
            
            listEl.innerHTML = '';
            people.forEach((p, index) => {
              const li = document.createElement('li');
              const name = typeof p === 'string' ? p : p.name || p;
              li.innerHTML = `
                <div style="display: flex; align-items: center; justify-content: between;">
                  <span>ğŸ‘¤ ${name}</span>
                  <small style="color: #6b7280; margin-left: auto;">#${index + 1}</small>
                </div>
              `;
              listEl.appendChild(li);
              
              // æ·»åŠ è¿›å…¥åŠ¨ç”»å»¶è¿Ÿ
              setTimeout(() => {
                li.style.opacity = '0';
                li.style.transform = 'translateY(20px)';
                li.style.transition = 'opacity 0.3s ease, transform 0.3s ease';
                setTimeout(() => {
                  li.style.opacity = '1';
                  li.style.transform = 'translateY(0)';
                }, index * 100);
              }, 10);
            });
          }
        } catch (e) {
          console.error(e);
          document.getElementById('peopleCount').innerHTML = 
            '<span style="color: #ef4444;">âŒ åŠ è½½å¤±è´¥</span>';
        }
      }
      
      // é¡µé¢åŠ è½½æ—¶åˆ·æ–°åˆ—è¡¨
      refreshPeople();
      
      // æ¯30ç§’è‡ªåŠ¨åˆ·æ–°ä¸€æ¬¡
      setInterval(refreshPeople, 30000);
    </script>
  </body>
</html>